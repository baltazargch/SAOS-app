{% extends "base.html" %} {% block title %}Descargas SAOS{% endblock %}

{% block main_content %}
<div class="dash__div" style="padding-top:1rem; width: 65%;margin: auto;">
    <h1 class="uk-heading-bullet uk-font-default">
        <span class="uk-text-background" style="font-size: smaller;">{{ current_user.nombre.upper() }}: Portal de
            descargas.</span>
    </h1>
    <div class="uk-text-background uk-text-default">
        Su rol actual es {{ current_user.tipo.upper() }}: A continuación, encontrarás las descargas disponbiles.
    </div>
    <hr>
    <br>
    <div>
        <div class="uk-child-width-1-1@s uk-child-width-1-3@m uk-text-center admin__dash" uk-grid="masonry: pack"
            style="font-size: smaller;">
            <div>
                <a href="#" , id="donwload__data">
                    <div class="uk-card uk-card-hover">
                        <div class="uk-card-media-top"
                            style="display: flex; justify-content: center ;align-items: center;">
                            <ion-icon name="file-tray-full-outline" class="ion-icon-xl"></ion-icon>
                        </div>
                        <div class="uk-card-body">
                            <h2 class="uk-card-title">Base de datos</h2>
                            <p>Descarga la información de pagos (.csv)</p>
                        </div>
                    </div>
                </a>
            </div>
            <div>
                <a href="#modal-maps" uk-toggle>
                    <div class="uk-card uk-card-hover">
                        <div class="uk-card-media-top"
                            style="display: flex; justify-content: center ;align-items: center;">
                            <ion-icon name="map-outline" class="ion-icon-xl"></ion-icon>
                        </div>
                        <div class="uk-card-body">
                            <h3 class="uk-card-title">Mapas</h3>
                            <p>Descarga la información de loteos (.kml)</p>
                        </div>
                    </div>
                </a>
            </div>
            <div>
                <a href="#">
                    <div class="uk-card uk-card-hover">
                        <div class="uk-card-media-top"
                            style="display: flex; justify-content: center ;align-items: center;">
                            <ion-icon name="home-outline" class="ion-icon-xl"></ion-icon>
                        </div>
                        <div class="uk-card-body">
                            <h3 class="uk-card-title">Construcción</h3>
                            <p>Descarga la información de construcción (.csv)</p>
                        </div>
                    </div>
                </a>
            </div>
        </div>
    </div>
    <div>
        <div id="modal-maps" uk-modal>
            <div class="uk-modal-dialog">
                <button class="uk-modal-close-default" type="button" uk-close></button>
                <div class="uk-modal-header">
                    <h2 class="uk-modal-title">Descargar mapas</h2>
                </div>
                <div class="uk-modal-body">
                    <p class="uk-text-warning">Mapas disponibles para descargar (.kml)</p>
                    <div class="uk-grid-match" uk-grid style="margin: auto;">
                        {%for f in files %}
                        <div class="uk-margin-remove uk-padding-small uk-text-small 
                            uk-card-small uk-width-auto uk-card uk-card-hover uk-card-body">
                            <a href="/maps_descargas/{{f}}">{{ f.replace('.geojson', '') }}</a>
                        </div>
                        {%endfor%}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.getElementById('donwload__data').addEventListener('click', function (event) {
        event.preventDefault(); // Evita el comportamiento predeterminado de navegación

        // Crea un formulario y agrega un campo de entrada
        var form = document.createElement('form');
        form.method = 'POST';
        form.action = '/descargar_csv'; // La URL a la que se enviará la solicitud POST

        // Agrega el formulario al cuerpo del documento y envíalo
        document.body.appendChild(form);
        form.submit();
    });
</script>
{%endblock%}